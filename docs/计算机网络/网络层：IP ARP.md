# 网络层IP、ARP

## IP

给主机分配的逻辑地址，可以是动态的

通过IP地址的⽹络位可以确定某个主机所在⽹络的位置，从⽽明确⼀条数据转发的路径。通过路由器不断寻址找到⽬的⽹段。





## 有了IP地址，为什么还要MAC地址
在局域⽹中通信需要通过MAC地址表记录主机和接⼝的映射关系来进⾏通信。

虽然同⼀⽹段也会⽤到ip地址，但是它在局域⽹中不起作⽤，因为arp是⽤于⽹络中寻址的，⽽在局域⽹中我们不需要⽤到⽹关进⾏通信，只需要找到⽬的MAC即可。

## ARP
**地址解析协议**，是根据IP地址获取MAC地址的一个网络层协议


每台主机都会在自己的ARP缓冲区维护一个ARP列表，存储IP地址和MAC地址的对应关系

局域网中，数据传输需要的是MAC地址，不是IP

ARP只在同一个广播域生效









### ARP 工作过程
源主机向目标主机发送请求数据包时，先检查本机ARP缓存中有没有该IP对应的MAC地址，有就直接向该MAC地址发送数据包，没有就发起包含目标主机的IP地址的ARP请求，ARP请求会广播到局域网中所有主机。

收到请求的主机会取出数据包中的IP来和自己的IP比较，如果相同就返回自己的MAC地址，不同就说明不是找自己的，丢弃数据包。

源主机收到返回消息，将返回的MAC地址与IP存到本机ARP缓存中保留一段时间，下次请求时，直接查询缓存，节省资源


### ARP攻击
ARP协议是建立在网络中各个主机互相信任的基础上的，局域网络上的主机可以自主发送ARP应答消息，其他主机收到应答报文时不会检测该报文的真实性就会将其记入本机ARP缓存；
由此攻击者就可以向某一主机发送假的ARP应答报文，使其发送的信息无法到达预期的主机或到达错误的主机，这就构成了一个ARP欺骗。
